{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '49070628-cf42e4c64cc07d7e6ab81af9e';\nconst BASE_URL = 'https://pixabay.com/api/';\naxios.defaults.baseURL = BASE_URL;\n\nconst searchParams = {\n  key: API_KEY,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: 1,\n  per_page: 40,\n};\n\nexport async function getPhotos(query, page) {\n  try {\n    const response = await axios.get('', {\n      params: { ...searchParams, q: query, page },\n    });\n    return response.data;\n  } catch (error) {\n    console.log(error);\n  }\n}\n","export function createGalleryMarkup(data = []) {\n  return data\n    .map((img = {}) => {\n      const {\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      } = img;\n      return `<li class=\"gallery-item\">\n        <a href=\"${largeImageURL}\">\n          <div class=\"gallery-top\">\n            <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" />\n          </div>\n          <ul class=\"gallery-bottom\">\n            <li class=\"gallery-bottom-item\">\n              <p class=\"gallery-bottom-stat\">Likes</p>\n              <p class=\"gallery-bottom-value\">${likes}</p>\n            </li>\n            <li class=\"gallery-bottom-item\">\n              <p class=\"gallery-bottom-stat\">Views</p>\n              <p class=\"gallery-bottom-value\">${views}</p>\n            </li>\n            <li class=\"gallery-bottom-item\">\n              <p class=\"gallery-bottom-stat\">Comments</p>\n              <p class=\"gallery-bottom-value\">${comments}</p>\n            </li>\n            <li class=\"gallery-bottom-item\">\n              <p class=\"gallery-bottom-stat\">Downloads</p>\n              <p class=\"gallery-bottom-value\">${downloads}</p>\n            </li>\n          </ul>\n          </a>\n        </li>`;\n    })\n    .join('');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { getPhotos } from './js/pixabay-api';\nimport { createGalleryMarkup } from './js/render-functions';\n\nconst formEl = document.querySelector('.search-form');\nconst galleryEl = document.querySelector('.gallery');\nconst loaderEl = document.querySelector('.loader');\nconst loadMoreBtnEl = document.querySelector('.load-more-btn');\nconst perPage = 40;\nlet searchQuery = '';\nlet currentPage = 1;\nlet totalPages = 0;\n\nformEl.addEventListener('submit', onSearchSubmit);\nloadMoreBtnEl.addEventListener('click', onLoadMoreBtnClick);\nconst lightboxInstance = new SimpleLightbox('.gallery a', {\n  /* options */\n});\n\nasync function onSearchSubmit(event) {\n  event.preventDefault();\n  const form = event.currentTarget;\n  searchQuery = form.elements.searchField.value.trim();\n  if (searchQuery === '') {\n    console.log('Query cannot be empty');\n    iziToast.error({\n      message:\n        'Query cannot be empty',\n      position: 'topRight',\n    });\n    return;\n  }\n  galleryEl.innerHTML = '';\n  currentPage = 1;\n  loaderEl.classList.remove('is-hidden');\n\n  try {\n    const { hits, totalHits } = await getPhotos(searchQuery, currentPage);\n    totalPages = Math.ceil(totalHits / perPage);\n\n    console.log('totalPages =' + totalPages );\n    console.log('totalHits =' + Math.ceil(totalHits) );\n    \n\n    if (hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      return;\n    }\n    renderGallery(hits);\n    if ( totalPages !==1 ) {\n      loadMoreBtnEl.classList.remove('is-hidden');\n    }\n    \n  } catch (error) {\n    console.log(error);\n  } finally {\n    loaderEl.classList.add('is-hidden');\n    setTimeout(() => {\n      form.reset();\n    }, 3000); // затримка у 300 мс для оновлення розмітки\n  }\n}\n\nasync function onLoadMoreBtnClick() {\n  currentPage += 1;\n  loaderEl.classList.remove('is-hidden');\n  try {\n    const { hits } = await getPhotos(searchQuery, currentPage);\n    renderGallery(hits);\n\n    if (currentPage >= totalPages) {\n      loadMoreBtnEl.classList.add('is-hidden');\n      iziToast.warning({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n    onScrollPage(galleryEl.firstElementChild);\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loaderEl.classList.add('is-hidden');\n  }\n}\n\nfunction onScrollPage(element) {\n  if (!element) {\n    return;\n  }\n  const { height } = element.getBoundingClientRect();\n\n  window.scrollBy({\n    top: height * 2,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nfunction renderGallery(images) {\n  const markup = createGalleryMarkup(images);\n  galleryEl.insertAdjacentHTML('beforeend', markup);\n  lightboxInstance.refresh();\n}\n"],"names":["API_KEY","BASE_URL","axios","searchParams","getPhotos","query","page","error","createGalleryMarkup","data","img","webformatURL","largeImageURL","tags","likes","views","comments","downloads","formEl","galleryEl","loaderEl","loadMoreBtnEl","perPage","searchQuery","currentPage","totalPages","onSearchSubmit","onLoadMoreBtnClick","lightboxInstance","SimpleLightbox","event","form","iziToast","hits","totalHits","renderGallery","onScrollPage","element","height","images","markup"],"mappings":"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"}